name: Deploy infrastructure to production
on:
  pull_request:
    branches:
      - 'master'
jobs:
  deploy-ansible-playbooks:
    runs-on: ubuntu-22.04
    steps:
      - name: Check out repository code
        uses: actions/checkout@v3
      - name: Run playbook
        uses: dawidd6/action-ansible-playbook@v4
        with:
            # Optional, directory where playbooks live
          directory: ./ansible
          # Required, playbook filepath
          playbook: ./playbooks/infrastructure.yml
          # Optional, SSH private key
          key: ${{secrets.SSH_PRIVATE_KEY}}
          # Optional, galaxy requirements filepath
          requirements: ./requirements.yml
